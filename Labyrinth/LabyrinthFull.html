<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Labyrinth - Digital Escape Room (Integrated)</title>

  <!-- Tailwind + Fonts (used by embedded modules too) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Cinzel:wght@600;800&display=swap"
    rel="stylesheet" />

  <style>
    :root {
      /* Light Garden palette */
      --brand-bg: #f7faf7;
      /* page background */
      --card: #ffffff;
      /* cards/scenes */
      --muted: #6b7280;
      /* muted text/borders (slate) */
      --ink: #111827;
      /* main text (near-black) */

      /* Greens for garden accent */
      --accent: #2f855a;
      /* primary button / progress start */
      --accent2: #86efac;
      /* progress end */

      /* Status */
      --ok: #16a34a;
      /* success */
      --err: #b91c1c;
      /* error */
    }

    /* Base layout & typography */
    html,
    body {
      margin: 0;
      background:
        radial-gradient(900px 400px at 20% -10%, rgba(34, 197, 94, .08), transparent),
        radial-gradient(900px 400px at 120% 10%, rgba(59, 130, 246, .06), transparent),
        var(--brand-bg);
      color: var(--ink);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* Sticky header */
    header.app {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(8px);
      background: rgba(255, 255, 255, .75);
      border-bottom: 1px solid rgba(17, 24, 39, .08);
    }

    header .inner {
      max-width: 980px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .title {
      font-family: Cinzel, serif;
      font-weight: 800;
      letter-spacing: .4px;
    }

    /* Progress */
    .progress {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
    }

    .progress>span {
      display: block;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width .35s ease;
    }

    .indicator {
      font-size: 1.5rem;
      opacity: .85;
    }

    /* Content wrapper */
    .wrap {
      max-width: 980px;
      margin: 24px auto 56px;
      padding: 0 16px;
    }

    /* Scene cards */
    .scene {
      display: none;
      background: var(--card);
      border: 1px solid rgba(17, 24, 39, .12);
      border-radius: 16px;
      padding: 24px;
      margin: 18px 0;
      box-shadow: 0 6px 14px rgba(0, 0, 0, .08);
      animation: fade .45s ease;
    }

    .scene.active {
      display: block;
    }

    @keyframes fade {
      from {
        opacity: 0;
        transform: translateY(6px)
      }

      to {
        opacity: 1;
        transform: none
      }
    }

    h2,
    h3 {
      margin: 0 0 16px 0;
      font-family: Cinzel, serif;
    }

    p {
      margin: 8px 0;
      color: var(--ink);
    }

    label {
      font-weight: 600;
    }

    /* Inputs (light) */
    input,
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      margin: 8px;
      color: var(--ink);
      background: #ffffff;
      border: 1px solid #cbd5e1;
      border-radius: 10px;
      box-sizing: border-box;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: 3px solid #bbf7d0;
      /* light green ring */
      outline-offset: 1px;
      border-color: #86efac;
    }

    /* Buttons (clear, high-contrast) */
    button {
      margin: 14px;
      padding: 16px;
      border: 2px solid #1f6a45;
      /* darker border for definition */
      border-radius: 10px;
      cursor: pointer;
      color: #ffffff;
      background: var(--accent);
      box-shadow: 0 1px 0 rgba(0, 0, 0, .05);
    }

    button:hover {
      filter: brightness(0.95);
    }

    button:active {
      transform: translateY(1px);
    }

    button:focus-visible {
      outline: 3px solid #bbf7d0;
      outline-offset: 2px;
    }

    button:disabled {
      opacity: .55;
      cursor: not-allowed;
    }

    /* Secondary (neutral) */
    button.secondary {
      background: #e2e8f0;
      color: #111827;
      border-color: #cbd5e1;
    }

    button.secondary:hover {
      background: #cbd5e1;
      filter: none;
    }

    /* Helpers */
    .hidden-answer {
      display: none;
      margin: 8px;
      font-style: italic;
      color: #374151;
    }

    .hint {
      color: #374151;
      opacity: .9;
    }

    /* Embedded module container */
    .embed-card {
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(17, 24, 39, .12);
      background: var(--card);
      padding: 16px;
    }

    /* === Consistent 8px rhythm (clean classroom spacing) === */

    /* Base line height for readability */
    html,
    body {
      line-height: 1.6;
    }

    /* Header spacing */
    header .inner {
      padding: 16px 24px;
    }

    /* Page wrapper */
    .wrap {
      max-width: 1100px;
      padding: 0 24px;
      margin: 32px auto 64px;
    }

    /* Scene cards */
    .scene {
      padding: 24px 24px;
      /* inner padding */
      margin: 16px;
      /* space between scenes */
      border-radius: 18px;
      box-shadow: 0 10px 28px rgba(0, 0, 0, .10);
    }

    /* 8px spacing between stacked elements */
    .scene>*+* {
      margin-top: 8px;
    }

    /* Inputs & selects */
    input,
    select,
    textarea {
      padding: 16px;
      border-radius: 8px;
      margin: 16px;
      font-size: 1.75rem;
    }

    /* Buttons */
    button {
      padding: 16px;
      border-radius: 8px;
      margin: 8px;
      font-size: 1.75rem;
    }

    /* Embedded puzzle containers */
    .embed-card {
      padding: 16px;
      border-radius: 12px;
      margin-top: 8px;
    }

    /* Progress bar slightly thicker for projection */
    .progress {
      height: 10px;
    }

    /* === Typography and spacing overrides === */

    /* Reset Tailwind form reset and enforce 8px rhythm */
    button,
    input,
    select,
    textarea {
      margin: 8px !important;
      padding: 8px !important;
      font-size: 1.5rem !important;
      line-height: 1.4 !important;
      box-sizing: border-box !important;
    }

    /* Paragraph spacing and readability */
    p {
      line-height: 1.5 !important;
      /* tighter but still readable */
      margin: 10px !important;
      /* consistent vertical rhythm */
      font-size: 1.75rem;
      color: var(--ink);
    }

    /* Heading hierarchy for projection-friendly text */
    h2 {
      font-family: Cinzel, serif;
      font-size: 2.3rem !important;
      /* about 24px */
      font-weight: 700;
      margin-top: 16px;
      margin-bottom: 8px;
      color: var(--ink);
    }

    h3 {
      font-family: Cinzel, serif;
      font-size: 1.75rem;
      /* about 20px */
      font-weight: 600;
      margin-top: 12px;
      margin-bottom: 6px;
      color: var(--ink);
    }

    /* === Ordered and unordered lists === */
    ol,
    ul {
      margin: 12px !important;
      padding-left: 24px;
      line-height: 1.5;
      font-size: 1.75rem;
      /* match <p> size */
      color: var(--ink);
    }

    li {
      margin-bottom: 12px;
      /* space between list items */
    }

    .story-card {
      background: #ffffff;
      border: 1px solid rgba(17, 24, 39, .1);
      border-radius: 16px;
      padding: 24px;
      margin: 60px 0;
      box-shadow: 0 8px 20px rgba(0, 0, 0, .08);
    }

    .story-img {
      display: block;
      margin: 24px auto;
      max-width: 90%;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, .15);
    }
  </style>

</head>

<body>

  <header class="app">
    <div class="inner">
      <div style="display:flex;align-items:center;gap:10px;">
        <div style="width:10px;height:10px;border-radius:999px;background:#22d3ee"></div>
        <div class="title">Katie‚Äôs The Labyrinth</div>
      </div>
      <div class="progress" aria-label="Progress"><span id="progressFill"></span></div>
      <div id="sceneIndicator" class="indicator">Scene 1 of 10</div>
    </div>
  </header>

  <div class="wrap" id="labyrinth">

    <!-- INTRO -->
    <section id="intro" class="scene active" data-key="password">
      <h2>Welcome to The Labyrinth</h2>
      <p>Welcome to <strong>The Labyrinth,</strong> a digital escape adventure for English language learners at an
        intermediate level. </p>
      <img
        src="https://quandarypeak.com/wp-content/uploads/2023/07/a_robot_gets_lost_in_a_garden_maze_view_from_above.png"
        alt="Labyrinth" class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto">
      <p></p>
      <label for="password">Please enter the access password which was provided with your purchase:</label>
      <input id="password" type="text" placeholder="Enter password" />
      <button onclick="checkPassword()">Start Adventure</button>
    </section>

    <!-- INSTRUCTIONS -->
    <section id="instructions" class="scene">
      <h2>Instructions</h2>
      <ol>

        <li><strong>1. Work as a Team</strong>: Complete the adventure by working together as a team.
        </li>

        <li><strong>2. Take Turns</strong>: Take turns reading the story cards out loud so everyone can
          participate.</li>

        <li><strong>3. Solve the Puzzles</strong>: As you read the story, there will be puzzles to solve. Work
          together to solve each puzzle and escape the labyrinth.</li>

        <li><strong>4. Have Fun</strong>: Enjoy this activity! It is about practice, not perfection.</li>
      </ol>

      <p><strong>Good luck!</strong></p>
      <button onclick="nextScene()">Start Adventure</button>
    </section>

    <!-- SCENE 1 OUR STORY BEGINS -->
    <section id="scene1" class="scene">

      <!-- Card 1 OF INTRO-->
      <div class="story-card">
        <p>Our story begins:</p><br>
        <p>You are in English class, and it is very hot. You feel tired, and you start to fall
          asleep ... </p>
        <img src="https://miro.medium.com/v2/resize:fit:1400/1*lPiraVH0T0GaH39dl3p8Hg@2x.jpeg" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto" style="display:block; margin:50px auto;">
      </div>

      <!-- Card 2 OF INTRO-->
      <div class="story-card">
        <p>Your eyes are half closed when you notice movement around you. The classroom is quickly filling with a thick
          fog. After a few seconds, you can't see
          or hear anything!</p>
        <img src="https://i.pinimg.com/originals/12/a7/e7/12a7e7aa7650fd526f43af704ed68acb.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>

      <!-- Card 3 OF INTRO-->
      <div class="story-card">
        <p>Another minute later, as fast as the fog appeared, it suddenly disappears. You can hear again.</p>
        <p>You look around, but you are not in the classroom anymore‚Äîyou are <em>outside</em> in a garden.</p>
      </div>

      <!-- Card Number OF INTRO-->
      <div class="story-card">
        <p>There are four tall walls surrounding you. Are you trapped?</p>
        <p>But then, someone shouts, "I think I see a door!"</p>
        <img src="LabyrinthImages/open door.jpeg" alt="Garden photo"
          class="w-full max-h-50 object-cover rounded-xl shadow-2xl mx-auto my-12" style="height: 500px; width:auto;">
      </div>

      <!-- Card 4 OF INTRO-->
      <div class="story-card">
        <p>What a relief! You all walk through the door.</p>
        <p>The moment everyone is through, the door slams shut.</p>
        <p>Then, like magic, vines grow and cover the door.</p>
        <img src="LabyrinthImages/door disappears.jpeg" alt="Garden photo"
          class="w-full max-h-50 object-cover rounded-xl shadow-2xl mx-auto my-12" style="height: 500px; width:auto;">
      </div>

      <!-- Card 5 OF INTRO-->
      <div class="story-card">
        <p>You look around. You are at the entrance of a huge labyrinth.</p>
        <p>You hear a booming voice that seems to be coming from everywhere say:</p>
        <p><strong>‚ÄúYou are trapped in our Labyrinth! The only way to escape is to solve our puzzles.‚Äù</strong> </p>
        <img src="https://miro.medium.com/v2/resize:fit:1080/1*UsHQciiGfZ0NPduYSKWH-Q.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto" style="display:block; margin:50px auto;">
      </div>

      <!-- Card 6 OF INTRO-->
      <div class="story-card">
        <p>Who said that? What puzzles?
          <br><br>
          With no other choice, you all decide to go forward into the labyrinth.
        </p>
      </div>
      <button onclick="nextScene()">Continue</button>
    </section>

    <!-- SCENE 2: St. Ives TEXT-->
    <section id="scene2" class="scene" data-key="stIves">
      <h2>The Riddle of St. Ives</h2>
      <!-- Card 1 ST IVES-->
      <div class="story-card">
        <p>You walk until you come to a dead end -- three high walls to the left, right, and front.
        </p>

        <p>You are about to turn back and try another direction when you hear a scratching sound.</p>
        <p>Shapes begin to appear on one of the walls.</p>
        <img src="LabyrinthImages/wallwriting.jpeg" alt="Wall photo"
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 2 ST IVES-->
      <div class="story-card">
        <p>It's a drawing, and below the drawing is some writing that says,</p>
        <p><strong>"Solve the riddle to move ahead. Solve it fast, or you'll be dead!"</strong></p>
      </div>
      <!-- Card 3 ST IVES-->
      <div class="story-card">
        <p>You hear a loud roar in the distance, and the sound of something <strong>very BIG</strong> running in your
          direction.</p>
        <img src="https://pa1.aminoapps.com/6476/9f4c06ebef1e0504ab3d104ba8d139ea4b0352c7_hq.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
        <p>Hurry and solve the riddle!</p>
      </div>
      <!-- Card 4 ST IVES-->
      <div class="story-card">
        <img src="LabyrinthImages/st-ives.gif" alt="St. Ives riddle"
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
        <p>As I was going to St. Ives<br>
          I met a man with seven wives<br>
          The seven wives had seven sacks<br>
          The seven sacks had seven cats<br>
          The seven cats had seven kittens<br>
          Kittens, cats, sacks, and wives --<br>
          How many were going to St. Ives?</p>
      </div>
      <!-- Scene 2: Riddle input -->
      <input id="stIvesAnswer" type="text" placeholder="Enter your answer here"
        class="w-full text-center border border-gray-400 rounded-lg p-4 my-4 text-lg" />
      <button onclick="checkAnswer('scene2','stIvesAnswer')">Submit</button>
      <p class="hidden-answer">Answer: 1 (only the narrator was going to St. Ives)</p>
    </section>


    <!-- POST SCENE 2: sliding down slide, shows its own Continue) -->
    <section id="scene2" class="scene">
      <!-- Card 1 POST ST IVES-->
      <div class="story-card">
        <p>As soon as you answer, the floor below you drops away like a door, and you all begin sliding down
          a long tunnel.</p>
        <img src="https://miro.medium.com/v2/resize:fit:1400/0*VMbmrFBsuPK6Khs8" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 2 POST ST IVES -->
      <div class="story-card">
        <p>You look back and see a pack of <strong>monsters</strong> with bright, white eyes and sharp teeth looking
          down into the tunnel!</p>
        <p>Thankfully, the monsters don't enter the tunnel, but you can hear the echo of their terrible noises as you
          slide away to safety.</p>
        <img
          src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/507bf817-d439-4c06-b370-0f63534d3626/d874js5-1188034b-8528-4d0a-9fc9-da35d476d202.gif?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiIvZi81MDdiZjgxNy1kNDM5LTRjMDYtYjM3MC0wZjYzNTM0ZDM2MjYvZDg3NGpzNS0xMTg4MDM0Yi04NTI4LTRkMGEtOWZjOS1kYTM1ZDQ3NmQyMDIuZ2lmIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0.Vlvwaig3LtOAQyDN1jmbcTi2EeKEq4G3M-lSqNSyUbQ"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>


      <!-- Card 3 POST ST IVES -->
      <div class="story-card">
        <p>You feel cold with fear.</p>
        <p>What other kinds of danger live in this labyrinth?</p>
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <!-- SCENE 3: LOCKS (improved version) -->
    <section id="scene3" class="scene">
      <h3>The Locked Door</h3>
      <!-- Story cards stay the same -->
      <div class="story-card">
        <p>The tunnel ends in the middle of another walled garden with only one door.</p>
        <p>You walk over to the door and see it is closed with four, big locks.</p>
        <img src="https://t4.ftcdn.net/jpg/00/03/75/17/360_F_3751712_Pchsbj2C1PX0Hxpt8soAKqi7ZZy2Sz7i.jpg" alt="photo"
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>

      <div class="story-card">
        <p>As you approach the door, a stone statue next to the door turns to you and begins to speak:</p>
        <p><strong>"I am guardian of this door! If you want to leave this garden, you must answer my questions
            correctly."</strong></p>
        <img
          src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKdMpeK2ppNPJQDBn7HOIhJOEbmjvDbW7ZwIT72ly0Z6rT4jvYjWYgDJKf-_SbS6AnEQg12pCaw11ubuKDEhGGrTKaGxesQH4UP0MPQIDbMuYTMI34QOxy_Y2klxdiyZpn122iPUeAIU4/s640/angels+2.gif"
          alt="photo" class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>

      <div class="story-card">
        <p>The statue is very creepy, but you bravely ask for the first question:</p>
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <section id="scene3locks" class="scene">
      <p style="text-align: center; font-size: 1.5rem; margin: 20px 0;">Answer the statue's questions to unlock each
        lock:</p>

      <!-- NEW IMPROVED LOCKS -->
      <style>
        .locks-container {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: 32px;
          margin: 32px 0;
        }

        .lock-box {
          background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
          border: 2px solid #475569;
          border-radius: 20px;
          padding: 24px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
          transition: all 0.3s ease;
        }

        .lock-box.unlocked {
          background: linear-gradient(135deg, #065f46 0%, #064e3b 100%);
          border-color: #10b981;
          box-shadow: 0 0 30px rgba(16, 185, 129, 0.4);
        }

        .lock-box.shake {
          animation: shake 0.5s;
        }

        @keyframes shake {

          0%,
          100% {
            transform: translateX(0);
          }

          25% {
            transform: translateX(-10px);
          }

          75% {
            transform: translateX(10px);
          }
        }

        .lock-visual {
          width: 100px;
          height: 120px;
          margin: 0 auto 20px;
          position: relative;
        }

        /* 3D Realistic Lock Body */
        .lock-body {
          width: 80px;
          height: 70px;
          background: linear-gradient(135deg, #94a3b8 0%, #475569 50%, #1e293b 100%);
          border-radius: 8px;
          position: absolute;
          bottom: 0;
          left: 10px;
          box-shadow:
            0 4px 8px rgba(0, 0, 0, 0.4),
            inset 0 -2px 4px rgba(0, 0, 0, 0.3),
            inset 0 2px 4px rgba(255, 255, 255, 0.1);
        }

        .lock-body::after {
          content: '';
          position: absolute;
          width: 12px;
          height: 20px;
          background: #1e293b;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          border-radius: 2px;
        }

        /* Shackle */
        .lock-shackle {
          width: 50px;
          height: 50px;
          border: 8px solid #d97706;
          border-bottom: none;
          border-radius: 50px 50px 0 0;
          position: absolute;
          top: 0;
          left: 25px;
          transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          box-shadow:
            inset 0 2px 4px rgba(255, 255, 255, 0.3),
            0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .lock-box.unlocked .lock-shackle {
          border-color: #10b981;
          transform: translateY(-25px) rotate(-10deg);
          box-shadow:
            inset 0 2px 4px rgba(255, 255, 255, 0.5),
            0 4px 12px rgba(16, 185, 129, 0.5);
        }

        .lock-question {
          color: #e2e8f0;
          font-size: 1.3rem;
          text-align: center;
          margin: 16px 0;
          min-height: 60px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .lock-input {
          width: 100%;
          padding: 12px;
          font-size: 1.3rem;
          text-align: center;
          border-radius: 8px;
          border: 2px solid #475569;
          background: #1e293b;
          color: #e2e8f0;
          transition: all 0.3s;
        }

        .lock-input:focus {
          outline: none;
          border-color: #3b82f6;
          background: #0f172a;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .lock-input:disabled {
          background: #064e3b;
          border-color: #10b981;
          color: #10b981;
          font-weight: bold;
          cursor: not-allowed;
        }

        .lock-status {
          text-align: center;
          font-size: 1.2rem;
          font-weight: bold;
          margin-top: 12px;
          color: #ef4444;
          transition: all 0.3s;
        }

        .lock-box.unlocked .lock-status {
          color: #10b981;
        }

        #locks-final-message {
          text-align: center;
          background: linear-gradient(135deg, #10b981 0%, #059669 100%);
          color: white;
          padding: 24px;
          border-radius: 16px;
          font-size: 2rem;
          font-weight: bold;
          margin: 32px 0;
          opacity: 0;
          transform: scale(0.8);
          transition: all 0.5s ease;
          box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        #locks-final-message.show {
          opacity: 1;
          transform: scale(1);
        }

        #locks-continue-btn {
          display: block;
          margin: 20px auto;
          padding: 16px 48px;
          font-size: 1.5rem;
          background: #2f855a;
          color: white;
          border: 2px solid #1f6a45;
          border-radius: 10px;
          cursor: pointer;
          transition: all 0.3s;
        }

        #locks-continue-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        #locks-continue-btn:not(:disabled):hover {
          background: #276749;
          transform: translateY(-2px);
          box-shadow: 0 8px 20px rgba(47, 133, 90, 0.3);
        }
      </style>

      <div class="locks-container">
        <!-- Lock 1 -->
        <div class="lock-box" id="lock1">
          <div class="lock-visual">
            <div class="lock-shackle"></div>
            <div class="lock-body"></div>
          </div>
          <div class="lock-question">What is the past participle of "throw?"</div>
          <input type="text" class="lock-input" id="lock1-input" placeholder="Type your answer">
          <div class="lock-status">üîí Locked</div>
        </div>

        <!-- Lock 2 -->
        <div class="lock-box" id="lock2">
          <div class="lock-visual">
            <div class="lock-shackle"></div>
            <div class="lock-body"></div>
          </div>
          <div class="lock-question">Which word is unnecessary in: "I am agree with you"?</div>
          <input type="text" class="lock-input" id="lock2-input" placeholder="Type your answer">
          <div class="lock-status">üîí Locked</div>
        </div>

        <!-- Lock 3 -->
        <div class="lock-box" id="lock3">
          <div class="lock-visual">
            <div class="lock-shackle"></div>
            <div class="lock-body"></div>
          </div>
          <div class="lock-question">Which word is missing in: "I will explain you the homework"?</div>
          <input type="text" class="lock-input" id="lock3-input" placeholder="Type your answer">
          <div class="lock-status">üîí Locked</div>
        </div>

        <!-- Lock 4 -->
        <div class="lock-box" id="lock4">
          <div class="lock-visual">
            <div class="lock-shackle"></div>
            <div class="lock-body"></div>
          </div>
          <div class="lock-question">Which is pronounced differently? (by / buy / buoy / bye)</div>
          <input type="text" class="lock-input" id="lock4-input" placeholder="Type your answer">
          <div class="lock-status">üîí Locked</div>
        </div>
      </div>

      <div id="locks-final-message">
        All Locks Unlocked! Click Continue
      </div>

      <button id="locks-continue-btn" disabled>Continue</button>

      <script>
        (function () {
          const correctAnswers = {
            'lock1': 'thrown',
            'lock2': 'am',
            'lock3': 'to',
            'lock4': 'buoy'
          };

          const unlockedLocks = new Set();

          function checkLock(lockId) {
            const input = document.getElementById(`${lockId}-input`);
            const lockBox = document.getElementById(lockId);
            const status = lockBox.querySelector('.lock-status');
            const answer = input.value.trim().toLowerCase();

            if (answer === correctAnswers[lockId]) {
              // CORRECT!
              lockBox.classList.add('unlocked');
              status.textContent = '‚úÖ Unlocked!';
              input.disabled = true;
              input.value = correctAnswers[lockId]; // Show correct answer
              unlockedLocks.add(lockId);

              toast(`Lock ${lockId.slice(-1)} unlocked!`, 'success');

              // Check if all unlocked
              if (unlockedLocks.size === 4) {
                const finalMsg = document.getElementById('locks-final-message');
                finalMsg.classList.add('show');
                document.getElementById('locks-continue-btn').disabled = false;
              }
            } else {
              // WRONG!
              lockBox.classList.add('shake');
              setTimeout(() => lockBox.classList.remove('shake'), 500);
              input.value = '';
              toast('Incorrect! Try again.', 'error');
            }
          }

          // Add enter key listeners
          for (let i = 1; i <= 4; i++) {
            const input = document.getElementById(`lock${i}-input`);
            input.addEventListener('keypress', (e) => {
              if (e.key === 'Enter') {
                checkLock(`lock${i}`);
              }
            });

            // Also check on blur (when they click away)
            input.addEventListener('blur', () => {
              if (input.value.trim() && !input.disabled) {
                checkLock(`lock${i}`);
              }
            });
          }

          document.getElementById('locks-continue-btn').addEventListener('click', () => {
            toast('The locks are open!', 'success');
            setTimeout(nextScene, 1500);
          });
        })();
      </script>
    </section>

    <!-- SCENE 4: LITERATURE (embedded, shows its own Continue) -->
    <section id="scene4a" class="scene">
      <h3>The Pond of Books</h3>
      <!-- Card 1 OF POND OF BOOKS -->
      <div class="story-card">
        <p>The door opens to a path, and you begin to walk. After a while, you get tired and sit down by a
          small pond.</p>
      </div>


      <!-- Card 2 OF POND OF BOOKS -->
      <div class="story-card">
        <p>You look into the water and see fish swimming around. Wait, they aren't fish, they're books!</p>
        <img src="https://drive.google.com/thumbnail?id=1FHjuAgQagNYGJDHO8eQJ9h4gFuFr07ck&sz=1600" alt="Garden photo"
          class="w-full max-h-50 object-cover rounded-xl shadow-2xl mx-auto my-12" style="height: 500px; width:auto;">
      </div>
      <!-- Card 3 OF POND OF BOOKS -->
      <div class="story-card">
        <p>You lean closer to read the names of the authors written on the spines of each swimming book....</p>
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <section id="scene4" class="scene">
      <h3>The Pond of Books</h3>
      <p>Drag and drop to sort each work into its category:</p>
      <p>#1: Literature from the United States of America vs </p>
      <p>#2: Non-USA Literature.</p>
      <p>Click "Verify" to check your answers.</p>

      <div class="embed-card" id="literature-embed">
        <!-- ===== BEGIN EMBED: literature-sort.html (trimmed head/body, self-contained) ===== -->
        <style>
          #item-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            background: #e9ecf2;
            padding: 12px;
            border-radius: 12px;
            border: 1px solid #4b5563
          }

          .drag-item {
            cursor: grab;
            background: #b7c6dc;
            border: 2px solid #6b7280;
            padding: 8px 10px;
            border-radius: 10px;
            font-weight: 600
          }

          .dragging {
            opacity: .5;
            border-style: dashed !important
          }

          .drop-zone {
            min-height: 220px;
            padding: 12px;
            border: 3px dashed #6b7280;
            border-radius: 12px
          }

          .drop-zone.drag-over {
            border-color: #fca311;
            background: #f8f8f6;
            transform: scale(1.01)
          }

          .correct {
            border-color: #10b981 !important;
            background: rgba(16, 185, 129, .1) !important;
            color: #10b981 !important
          }

          #final-message {
            opacity: 0;
            transition: opacity 1s;
            background: #10b981;
            border: 2px solid #050300;
            margin: 12px;
            padding: 14px;
            border-radius: 12px
          }

          #final-message:not(.hidden) {
            opacity: 1
          }
        </style>

        <div id="item-pool"></div>
        <div class="flex flex-col md:flex-row" style="gap:16px;margin:14px;">
          <div id="us-column" class="drop-zone" style="flex:1;">
            <h4 class="title-font text-xl" style="color:#3120ec">üá∫üá∏ (US) American Literature</h4>
            <div class="col-inner" style="display:flex;flex-direction:column;gap:8px;min-height:200px;"></div>
          </div>
          <div id="non-us-column" class="drop-zone" style="flex:1;">
            <h4 class="title-font text-xl" style="color:#075f2d">üåç Non-(US) American Literature</h4>
            <div class="col-inner" style="display:flex;flex-direction:column;gap:8px;min-height:200px;"></div>
          </div>
        </div>

        <button id="check-button" class="mt-3 px-4 py-2 rounded" style="background:#e7e6f5">Verify Your Answers</button>

        <div id="final-message" class="hidden">
          <h4 class="title-font text-2xl font-bold text-white mb-2">Challenge Complete! Click Continue</h4>
        </div>

        <!-- Module‚Äôs own Continue (Option 1) -->
        <button id="literature-continue" class="mt-3 px-4 py-2 rounded bg-slate-600 text-white"
          disabled>Continue</button>

        <script>
          (function () {
            const items = [
              { id: 'item-fitzgerald', text: 'F. Scott Fitzgerald / The Great Gatsby', correctColumn: 'us-column' },
              { id: 'item-mann', text: 'Thomas Mann / The Magic Mountain', correctColumn: 'non-us-column' },
              { id: 'item-hemingway', text: 'Ernest Hemingway / The Old Man and the Sea', correctColumn: 'us-column' },
              { id: 'item-hugo', text: 'Victor Hugo / Les Mis√©rables', correctColumn: 'non-us-column' },
              { id: 'item-twain', text: 'Mark Twain / The Adventures of Tom Sawyer', correctColumn: 'us-column' },
              { id: 'item-allende', text: 'Isabel Allende / City of the Beasts', correctColumn: 'non-us-column' },
              { id: 'item-angelou', text: 'Maya Angelou / And Still I Rise', correctColumn: 'us-column' },
              { id: 'item-zafon', text: 'Carlos Ruiz Zaf√≥n / The Shadow of the Wind', correctColumn: 'non-us-column' },
              { id: 'item-gomez', text: 'Juan G√≥mez-Jurado / Reina Roja', correctColumn: 'non-us-column' },
              { id: 'item-vonnegut', text: 'Kurt Vonnegut / Slaughterhouse-Five', correctColumn: 'us-column' },
              { id: 'item-rowling', text: 'J. K. Rowling / Harry Potter Series', correctColumn: 'non-us-column' },
              { id: 'item-dickinson', text: 'Emily Dickinson / Poems of Emily Dickinson', correctColumn: 'us-column' },
              { id: 'item-kafka', text: 'Franz Kafka / The Metamorphosis', correctColumn: 'non-us-column' },
              { id: 'item-brown', text: 'Dan Brown / The Da Vinci Code', correctColumn: 'us-column' },
              { id: 'item-adiga', text: 'Aravind Adiga / The White Tiger', correctColumn: 'non-us-column' },
              { id: 'item-plath', text: 'Sylvia Plath / The Bell Jar', correctColumn: 'us-column' },
              { id: 'item-murakami', text: 'Haruki Murakami / Norwegian Wood', correctColumn: 'non-us-column' },
            ];
            let dragged = null;
            const pool = document.getElementById('item-pool');
            const us = document.querySelector('#us-column .col-inner');
            const non = document.querySelector('#non-us-column .col-inner');
            const finalBox = document.getElementById('final-message');
            const cont = document.getElementById('literature-continue');

            items.forEach(d => {
              const el = document.createElement('div'); el.id = d.id; el.className = 'drag-item'; el.textContent = d.text; el.draggable = true;
              el.setAttribute('data-correct', d.correctColumn);
              el.addEventListener('dragstart', e => { dragged = e.target; e.dataTransfer.setData('text/plain', e.target.id); setTimeout(() => e.target.classList.add('dragging'), 0) });
              el.addEventListener('dragend', e => { e.target.classList.remove('dragging'); dragged = null });
              pool.appendChild(el);
            });
            document.querySelectorAll('.drop-zone .col-inner').forEach(zone => {
              const parent = zone.closest('.drop-zone');
              zone.addEventListener('dragover', e => { e.preventDefault(); parent.classList.add('drag-over') });
              zone.addEventListener('dragleave', () => parent.classList.remove('drag-over'));
              zone.addEventListener('drop', e => {
                e.preventDefault(); const id = e.dataTransfer.getData('text/plain'); const el = document.getElementById(id);
                parent.classList.remove('drag-over'); if (el) { zone.appendChild(el); el.classList.remove('correct') }
                finalBox.classList.add('hidden'); finalBox.style.opacity = '0';
              });
            });

            function toast(m, t = 'error') { const b = document.createElement('div'); b.className = 'fixed top-4 left-1/2 -translate-x-1/2 z-50 p-3 rounded-xl shadow text-center font-semibold'; b.textContent = m; b.style.background = (t === 'success') ? '#16a34a' : '#dc2626'; b.style.color = '#fff'; document.body.appendChild(b); setTimeout(() => { b.style.opacity = '0'; b.addEventListener('transitionend', () => b.remove()) }, 2000) }

            function check() {
              let all = true, placed = 0;
              [us, non].forEach(zone => {
                const colId = zone.closest('.drop-zone').id;
                zone.querySelectorAll('.drag-item').forEach(it => {
                  placed++; const correctCol = it.getAttribute('data-correct');
                  if (correctCol === colId) { it.classList.add('correct') } else { it.classList.remove('correct'); all = false }
                });
              });
              if (placed < items.length) { toast(`Place all ${items.length} items first!`); all = false }
              else if (all) { toast('Literary alignment achieved!', 'success'); finalBox.classList.remove('hidden'); finalBox.style.opacity = '1'; cont.disabled = false; }
              else { toast('Incorrect classifications remain.') }
            }
            document.getElementById('check-button').addEventListener('click', check);
            cont.addEventListener('click', () => {
              if (typeof nextScene === 'function') {
                toast('Literary challenge complete! Click Continue', 'success');
                setTimeout(nextScene, 3500);
              }
            });
          })(); 
        </script>
        <!-- ===== END EMBED ===== -->
      </div>
    </section>

    <!-- ===== SCENE 5: THE CAT RIDDLES (NEW) ===== -->
    <section id="scene5" class="scene" data-key="cat">
      <h2>The Cat</h2>
      <!-- Card -->
      <div class="story-card">
        <p>How much time has passed? How long were you by the pond? You have wasted too much time.</p>
        <p>You continue down the path.</p>
        <img src="https://miro.medium.com/v2/resize:fit:852/1*mCYuw47S0J3ZwRNuQ32FmA.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card -->
      <div class="story-card">
        <p> After a few minutes, you hear something BIG moving in the bushes nearby. You stop and listen.</p>
        <p>The sound of moving leaves and breaking twigs grows louder and louder</p>
      </div>
      <!-- Card -->
      <div class="story-card">
        <p>A cat statue as big as a car jumps out from behind a bush, and crouches in front of you, blocking your way
          forward.</p>
        <img src="/LabyrinthImages/catstatue.gif" alt="Cat Statue"
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <div class="story-card">
        <p><strong>"Hello‚ÄîDon't you look like some tasty treats!"</strong> growls the cat statue. <strong>"You will be
            my dinner tonight if you cannot answer my riddles."</strong></p>
      </div>
      <div class="story-card">
        <p>You are terrified, but the challenge is clear; solve the cat's riddles or you will be dinner!</p>
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <section id="scene5catriddles" class="scene" data-key="cat-riddles">
      <div class="story-card">
        <p style="font-size: 1.75em; font-style: italic;">Solve the cat's riddles:</p>
      </div>
      <div><label style="font-size: 1.75em; font-weight:300;">1. How many letters are in <strong>THE
            ALPHABET?</strong></label><input id="cat1" type="text" /></div>
      <div><label style="font-size: 1.75em; font-weight:300;">2. What has <strong>a face</strong> and <strong>two
            hands</strong> but <strong>no arms or legs?</strong></label><input id="cat2" type="text" /></div>
      <div><label style="font-size: 1.75em; font-weight:300;">3. A <strong>woman and ten friends</strong> share an
          <strong>umbrella</strong> but no one <strong>gets wet</strong>. How?</label><input id="cat3" type="text" />
      </div>
      <button onclick="checkCatRiddles()">Submit</button>
      <p id="cat-feedback" class="text-center font-semibold"></p>
      <p class="hidden-answer">Answers: 11, clock, it‚Äôs not raining.</p>
    </section>

    <section id="scene5end" class="scene">
      <h2>The Feline Guardian</h2>
      <!-- Card -->
      <div class="story-card">
        <p><strong>"Correct!" Hisses the cat. "You may pass."</strong></p>
        <p>You all quickly run past the cat statue. You are sure that if you had stayed for another second, it would
          have changed its mind and eaten you all. </p>
        <img src="https://64.media.tumblr.com/6866835964be76040e6f4652017f7bb1/tumblr_n2m20gckF21sagvlzo4_500.gifv"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <!-- SCENE 6: Tell a story (embedded, shows its own Continue) -->
    <section id="scene6intro" class="scene">
      <h3>The Apple Tree</h3>
      <p>After a few minutes of walking, the path opens up to a small garden area with a huge apple tree planted in the
        middle.</p>
      <!-- Card 1 OF MADLIBS-->
      <div class="story-card">
        <p>You aren't sure how long you have been walking in the maze, but you are hungry. Your group decides to
          try eating the apples ‚Äî what is the worst thing that could happen?</p>
        <img src="https://www.shutterstock.com/image-photo/dark-apple-tree-middle-garden-260nw-2518418487.jpg"
          alt="photo" class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <section id="scene6intro2" class="scene">
      <h3>The Apple Tree</h3>
      <!-- Card 2 OF MADLIBS-->
      <div class="story-card">
        <p>The apples are delicious! But, you are all too busy eating to notice when the tree begins to move... </p>
        <p>The tree comes to life, and is like a giant tree monster. It grabs all of you up into its branches. You can't escape!</p>
        <img src="/LabyrinthImages/angrytree.jpeg" alt="photo"
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 3 OF MADLIBS-->
      <div class="story-card">
        <p>The tree says,</p>

        <p><strong>"You have enjoyed my apples, and now it is time to pay. Once you have told me an entertaining story,
            I will let you go. If I do not like your story, your time in the labyrinth with have a very bad ending!"</strong></p>
      </div>
      <!-- Card 4 OF MADLIBS-->
      <div class="story-card">
        <p>Your instructions are clear. You begin to tell the most amazing story that you can think of...</p>
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>

    <section id="scene6" class="scene">
      <div class="embed-card" id="story-embed">
        <!-- ===== BEGIN EMBED: tell-story.html (trimmed head/body, self-contained) ===== -->
        <style>
          .story-output-box {
            border: 2px solid #6366f1;
            position: sticky;
            top: 80px;
            z-index: 10;
            background: white;
            max-height: 400px;
            overflow-y: auto;
          }

          .tree-reaction-box {
            border: 2px solid #34d399;
          }

          /* Make numbered input labels bigger */
          .madlibs-label {
            font-size: 1.5em;
            font-weight: bold;
          }

          /* Make input text normal size and placeholder smaller */
          #story-module input {
            font-size: 1em;
          }

          #story-module input::placeholder {
            font-size: 0.75em;
          }
        </style>

        <div id="story-module">
          <h4 class="title-font text-3xl mb-2"
            style="background:linear-gradient(90deg,#fde047,#f59e0b);-webkit-background-clip:text;color:transparent">
            The Best Story Ever</h4>
          <p class="text-black text-base mb-3">Tell the <strong>tree monster</strong> a great story. Fill in each blank with the correct type of word, then click "Tell Part 1 of your story."</p>

          <div id="madlibs-inputs">
          </div>

          <button id="generate-story-button" class="mt-3 px-4 py-2 rounded" style="background:#86efac">Tell Part 1 of
            your story</button>

          <div id="story-output" class="hidden mt-4 p-4 rounded-xl bg-gray-100 story-output-box">
            <h5 class="title-font text-2xl text-indigo-400 mb-2">Part 1: The Origin of Power</h5>
            <p id="story-text" class="text-base leading-relaxed whitespace-pre-wrap"></p>
          </div>

          <button id="check-tree-part1-button" class="hidden mt-3 px-4 py-2 rounded bg-red-600">See if the tree is
            liking your story</button>
          <button id="check-tree-final-button" class="hidden mt-3 px-4 py-2 rounded bg-indigo-600">See if the tree liked
            your story</button>

          <div id="tree-reaction-output" class="hidden mt-4 p-4 rounded-xl bg-green-900 tree-reaction-box">
            <h5 class="title-font text-2xl text-green-400 mb-2">The Tree's Decision:</h5>
            <p id="tree-verdict-text" class="text-lg text-gray-100 mb-2"></p>
            <div class="mt-4 pt-4" style="border-top:1px solid #22c55e"></div>
          </div>

          <!-- Module's own Continue (Option 1) -->
          <button id="story-continue" class="mt-3 px-4 py-2 rounded bg-slate-600 text-white" disabled>Continue</button>
        </div>

        <script>
          (function () {
            let storyPart1 = "", stage = 1, heroName = "";
            const part1 = [
              { id: 'properNoun1', label: '1. Proper Name (Person)', type: 'text', placeholder: 'e.g., Bruce Wayne' },
              { id: 'adjective1', label: '2. Describing Word (Adjective)', type: 'text', placeholder: 'e.g., Shining' },
              { id: 'adjective2', label: '3. Describing Word (Adjective)', type: 'text', placeholder: 'e.g., Strange' },
              { id: 'verb1', label: '4. Action Word (Verb)', type: 'text', placeholder: 'e.g., Walk' },
              { id: 'adverb1', label: '5. Action Word (-ly Adverb)', type: 'text', placeholder: 'e.g., Quickly' },
              { id: 'adjective3', label: '6. Describing Word (for clothing)', type: 'text', placeholder: 'e.g., Colorful' },
              { id: 'properNoun2', label: '7. Proper Noun (Hero Name - title)', type: 'text', placeholder: 'e.g., The Guardian' },
              { id: 'nounSingular1', label: '8. Noun (Event)', type: 'text', placeholder: 'e.g., Concert' },
            ];
            const part2 = [
              { id: 'noun2', label: '9. Noun (Concept)', type: 'text', placeholder: 'e.g., Power' },
              { id: 'noun3', label: '10. Noun (Concept)', type: 'text', placeholder: 'e.g., Responsibility' },
              { id: 'adjective4', label: '11. Describing Word (Feeling)', type: 'text', placeholder: 'e.g., Difficult' },
              { id: 'nounPlural1', label: '12. Noun (Plural, People)', type: 'text', placeholder: 'e.g., Thieves' },
              { id: 'nounPlural2', label: '13. Noun (Plural, People)', type: 'text', placeholder: 'e.g., Children' },
              { id: 'nounPlural3', label: '14. Noun (Plural, People)', type: 'text', placeholder: 'e.g., Neighbors' },
              { id: 'verb2', label: '15. Action Word (Past Tense Verb)', type: 'text', placeholder: 'e.g., Rushed' },
              { id: 'verb3', label: '16. Action Word (Present Tense Verb)', type: 'text', placeholder: 'e.g., Hurt' },
            ];

            const t1 = `
\${properNoun1} was an ordinary student who loved to help others. They lived in a small apartment with their grandmother in the city. Every day, they walked to school past the old science museum.

One afternoon, \${properNoun1} decided to visit the museum. While looking at an ancient artifact, they accidentally touched a glowing, \${adjective1} stone. Suddenly, they felt \${adjective2}! 

When \${properNoun1} got home, strange things started happening. They discovered they could \${verb1} through walls, become invisible, and move \${adverb1}. At first, \${properNoun1} was scared. But then they realized these powers could be super useful!

\${properNoun1} made a \${adjective3} disguise and called themselves "\${properNoun2}." They used their powers to make crazy TikTok videos and terrorize the bullies at school. One day, after coming home from a \${nounSingular1}, \${properNoun1} saw their grandmother looking worried. 

"Someone stole my purse at the market," she said sadly. "It had all our money for this month."

\${properNoun1} felt terrible. They had been too busy having fun with their powers. They should have been watching out for their grandmother!
`;

            const t2 = `
<br><h3 class="title-font text-2xl text-indigo-400 mb-2">Part 2: Becoming a True Hero</h3>

That night, \${properNoun1} couldn't sleep. Their grandmother always said, "With great \${noun2} comes great \${noun3}." Now they understood what that meant. Having special abilities meant using them to protect others.

The next day, \${properNoun1} worked hard to find the thief. It was \${adjective4}, but they didn't give up. They returned the purse and caught several other thieves too!

From that day forward, \${properNoun1} became the city's secret protector. They stopped \${nounPlural1} from causing trouble, helped \${nounPlural2} who were in danger, and rescued \${nounPlural3} whenever they could.

Being a hero wasn't always easy. Sometimes \${properNoun1} was tired or scared. But whenever someone needed help, they \${verb2} to save them. They knew that if they didn't act, someone might get \${verb3}.

And their grandmother? She never knew her grandchild was the mysterious hero everyone was talking about. But she was proud anyway, because \${properNoun1} had always had a hero's heart.
`;

            const $ = (id) => document.getElementById(id);

            function initInputs(parts) {
              const box = $('madlibs-inputs');
              box.innerHTML = '';
              parts.forEach(p => {
                const w = document.createElement('div');
                w.className = 'flex flex-col gap-1';
                const lab = document.createElement('label');
                lab.innerHTML = p.label;
                lab.className = 'madlibs-label';
                const inp = document.createElement('input');
                inp.id = p.id;
                inp.type = p.type;
                inp.placeholder = p.placeholder;
                inp.className = 'w-full p-2 rounded bg-gray-100 border border-gray-600 text-black';
                w.appendChild(lab);
                w.appendChild(inp);
                box.appendChild(w);
              });
            }

            function process(parts, tpl) {
              let story = tpl, missing = false;
              parts.forEach(p => {
                const el = $(p.id);
                if (!el) return;
                const v = el.value.trim();
                if (!v) {
                  missing = true;
                  el.classList.add('ring-2', 'ring-red-500');
                } else {
                  el.classList.remove('ring-2', 'ring-red-500');
                  story = story.replace(new RegExp(`\\\$\\{${p.id}\\}`, 'g'), `<span class="font-extrabold text-red-600">${v}</span>`);
                }
              });
              return { story, missing };
            }

            function toast(m, t = 'error') {
              const b = document.createElement('div');
              b.className = 'fixed top-4 left-1/2 -translate-x-1/2 z-50 p-3 rounded-xl shadow text-center font-semibold';
              b.textContent = m;
              b.style.background = (t === 'success') ? '#16a34a' : '#dc2626';
              b.style.color = '#fff';
              document.body.appendChild(b);
              setTimeout(() => {
                b.style.opacity = '0';
                b.addEventListener('transitionend', () => b.remove())
              }, 3500);
            }

            function genPart1() {
              const out = $('story-output'), text = $('story-text'), next = $('check-tree-part1-button'), gen = $('generate-story-button');
              const r = process(part1, t1);
              if (r.missing) {
                toast('Please fill in all the blanks for Part 1!');
                out.classList.add('hidden');
                next.classList.add('hidden');
                return;
              }
              heroName = $('properNoun1').value.trim();
              storyPart1 = r.story;
              text.innerHTML = storyPart1;
              out.classList.remove('hidden');
              next.classList.remove('hidden');
              document.querySelectorAll('#madlibs-inputs input').forEach(i => i.disabled = true);
              gen.disabled = true;
              toast('Part 1 is ready! Present it to the Tree.', 'success');
            }

            function checkPart1() {
              const next = $('check-tree-part1-button'), gen = $('generate-story-button');
              toast('The tree seems very interested. Scroll to the top of the page to continue your story!', 'success');
              stage = 2;
              initInputs(part2);
              gen.textContent = 'Tell the Conclusion';
              gen.onclick = genPart2;
              gen.disabled = false;
              next.classList.add('hidden');
              $('tree-reaction-output').classList.add('hidden');
            }

            function genPart2() {
              const text = $('story-text');
              const fin = $('check-tree-final-button');
              const r = process(part2, t2);
              if (r.missing) {
                toast('Please fill in all the blanks for Part 2!');
                fin.classList.add('hidden');
                return;
              }
              // ensure properNoun1 (heroName) survives into part 2 if used
              const withHero = r.story.replace(/\$\{\s*properNoun1\s*\}/g, `<span class="font-extrabold text-red-600">${heroName}</span>`);
              text.innerHTML = storyPart1 + withHero;
              document.querySelectorAll('#madlibs-inputs input').forEach(i => i.disabled = true);
              $('generate-story-button').disabled = true;
              fin.classList.remove('hidden');
              toast('The Epic is complete! Scroll down to read the second half and present the grand finale to the Tree.', 'success');
            }

            function finalCheck() {
              const out = $('tree-reaction-output');
              const verdict = $('tree-verdict-text');
              verdict.innerHTML = 'The enchanted tree glows with satisfaction! "An inspiring epic! Click continue."';
              out.classList.remove('hidden');
              $('check-tree-final-button').disabled = true;
              toast('Success! The Tree is pleased.', 'success');
              // enable this module's Continue
              $('story-continue').disabled = false;
            }

            // wire buttons
            $('generate-story-button').addEventListener('click', genPart1);
            $('check-tree-part1-button').addEventListener('click', checkPart1);
            $('check-tree-final-button').addEventListener('click', finalCheck);
            $('story-continue').addEventListener('click', () => {
              if (typeof nextScene === 'function') {
                toast('The tree releases you!', 'success');
                setTimeout(nextScene, 3500);
              }
            });

            // init
            initInputs(part1);
          })();
        </script>
        <!-- ===== END EMBED ===== -->
      </div>
    </section>

    <!-- SCENE 7: Unscramble the Vines -->
    <section id="scene7" class="scene" data-key="vines">
      <!-- Card 1 UNSCRAMBLE THE VINES -->
      <div class="story-card">
        <p>What a relief! You all grab an extra apple and continue on your way</p>
        <img src="https://i.gifer.com/Nn2.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
        <button onclick="nextScene()">Continue</button>
      </div>
    </section>
    <section id="scene7b" class="scene" data-key="vines2">
      <div class="story-card">
        <p>You walk for another 10 minutes, turn a corner, and run into a web of tangled vines. You will need to untangle them to continue
          forward.</p>
        <img src="https://cdn.pixabay.com/photo/2014/07/22/05/04/roots-399109_1280.jpg" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <div class="story-card">
        <p>To successfully untangle the vines, unscramble the following labyrinth-related words:</p>
      </div>
      <h3>Untangle the Vines</h3>
      <p>Unscramble the labyrinth words:</p>
      <ul style="list-style:none;padding-left:0">
        <li>zeam ‚Üí <input id="vine1" /></li>
        <li>ttaues ‚Üí <input id="vine2" /></li>
        <li>zpluze ‚Üí <input id="vine3" /></li>
        <li>kolc ‚Üí <input id="vine4" /></li>
        <li>tsol ‚Üí <input id="vine5" /></li>
      </ul>
      <button onclick="checkVines()">Submit</button>
      <p class="hidden-answer">Answers: maze, statue, puzzle, lock, lost</p>
    </section>

    <!-- SCENE 8: Choose a Path -->
    <section id="scene8" class="scene" data-key="path">
      <h3>The Fork in the Maze</h3>
      <!-- Card 1 CHOOSE A PATH-->
      <div class="story-card">
        <p>It took a while, but you made it past the vines. You keep walking until you come to a fork in the path with
          five options. There is a sign, but the options keep changing and moving.</p>
        <img src="LabyrinthImages/signfork.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 1 CHOOSE A PATH-->
      <div class="story-card">
        <p>A giant leaf flutters down from a tree overhead, and on it is written:</p>
        <img
          src="LabyrinthImages/Leaf with Clue.png"
          alt=‚Äúphoto‚Äù class="w-full max-h-100 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 3 CHOOSE A PATH-->
      <div class="story-card">
        <p>Why is everything in this labyrinth so confusing? You turn the leaf over. There is more writing.
        </p>
        <p><a href="https://wordwall.net/resource/44908/english/grammar-quiz" target="_blank"
            style="color: #2563eb; text-decoration: underline; font-weight: 600;">See what the writing says</a>
        </p>
      </div>
      <label>What is the name of the path you choose?:</label>
      <select id="pathChoice">
        <option>Michael</option>
        <option>Mitchell</option>
        <option>Michelle</option>
        <option>Mandy</option>
        <option>Mary</option>
      </select>
      <button onclick="checkAnswer('scene8','pathChoice')">Continue</button>
      <p class="hidden-answer">Answer: Michelle</p>
    </section>

    <!-- SCENE 9: Gargoyle -->
    <section id="scene9" class="scene" data-key="gargoyle">
      <h3>The Gargoyle‚Äôs Challenge</h3>
      <!-- Card 1 GARGOYLE -->
      <div class="story-card">
        <p>You walk down the passage marked "Michelle." You find yourself in a room with high ceilings, and stone
          columns everywhere.</p>

        <p>It's pretty dark, but you think you see a glowing door at the end. Could that be the exit?</p>

        <p>You take a few steps forward.</p>
        <img
          src="https://lh7-rt.googleusercontent.com/formsz/AN7BsVC4end1B7J1ERs1dgbAHq2Oh6TM5nHU8xlWnXjMvAyfXHjXfX9hCa89v5tArBccRx2JtRGMVWPxRGSogKocXSBax_vmibcP8PqIIUp0nzdIL7JmGoM62BP-I295fPIpLDUZII20MuZA3-i_KpF6JezUju79zQdKf_S25g?key=0E0OASAS6FB8mwZBC4wnqw"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 2 GARGOYLE -->
      <div class="story-card">
        <p>You jump when a little gargoyle statue at the end of the hall, near the door, begins to speak:</p>

        <p style="font-weight:bold;">"Your journey is nearly over. If you complete my challenge, you have nothing to
          fear. All you must do is tell me...</p>
      </div>
      <!-- Card 3 GARGOYLE -->
      <div class="story-card">
        <img
          src="https://lh7-rt.googleusercontent.com/formsz/AN7BsVBmGJffjxmFvv63CW2kTSs_TyHQONGRuzUnWy_DOJbZXMTLgrLYdwGIyTk7ODMZASjLhjGWGsqB0GrPZI6_TxG8daQASDBXKAPQ-XAyo1NMRl_m0JUv6aSvt9d9V7LB1v1JQUFNr8t-kvQo8U_3nVfVDZXo3Y9VGMMQRg?key=0E0OASAS6FB8mwZBC4wnqw"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 4 GARGOYLE -->
      <div class="story-card">
        <p>"What do <a
            href="https://lingoclip.com/?ref=https%3A%2F%2Flyricstraining.com%2Fen%2Fplay%2Fbackstreet-boys%2Fi-want-it-that-way%2FUnMdGuRFHn"
            target="_blank" style="color: #2563eb; text-decoration: underline; font-weight: 600;">I never want to hear
            you say?</a>"</p> <input id="gargoyleAnswer" placeholder="Your answer" />
      </div>
      <button onclick="checkAnswer('scene9','gargoyleAnswer')">Submit</button>
      <p class="hidden-answer">Answer: I want it that way</p>
    </section>

    <!-- SCENE 10: The Return -->
    <section id="scene10" class="scene">
      <h3>You Escaped!</h3>
      <!-- Card 1 THE RETURN -->
      <div class="story-card">
        <p>The moment you tell the gargoyle, "I want it that way!" he begins to laugh...</p>

        <p>...and laugh and laugh .... </p>

        <p>And then fog surrounds you on all sides</p>
        <img src="https://i.pinimg.com/originals/12/a7/e7/12a7e7aa7650fd526f43af704ed68acb.gif" alt=‚Äúphoto‚Äù
          class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 2 THE RETURN -->
      <div class="story-card">
        <p>You open your eyes.</p>

        <p>You are back in the classroom! It must have been a dream! But, as you sit up straighter in your chair, you
          see something stuck to your shirt...</p>
        <img
          src="LabyrinthImages/was it a dream.png"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <!-- Card 3 THE RETURN -->
      <div class="story-card">
        <p>Wait....</p>

        <p>Was it a dream?!</p>
        <img
          src="https://lh7-rt.googleusercontent.com/formsz/AN7BsVA6lgJhE0kNUYEj4gzyWaWoUWn3awZkypBJHI8eCALYSScbXn00NdbSQYEgL1K7YMIWvYmmF79-kmABKOyIdQYL-AHi3Z3skR3T5v365ZgnPVDfvgzO6N-HDfoc-7ZYL9y8lJY4KNJCpnD4c6zpc5E0L-lzihqZnZZv8w?key=0E0OASAS6FB8mwZBC4wnqw"
          alt=‚Äúphoto‚Äù class="w-full max-h-96 object-cover rounded-xl shadow-2xl mx-auto my-18">
      </div>
      <button onclick="nextScene()">Continue</button>
    </section>
    <!-- SCENE Feedback: The Return -->
    <section id="feedback" class="scene">
      <h3>Thank You!</h3>
      <!-- Card 1 FEEDBACK -->
      <div class="story-card">
        <p>I hope you have enjoyed the Labyrinth! If you have any feedback‚Äîquestions, issues, concerns,
          recommendations‚Äîplease leave them below.</p>
      </div>
      <iframe
        src="https://docs.google.com/forms/d/e/1FAIpQLSc7uyIIRW2Nu13XwAXoEQ5LWT_fv6b0kcRPNwFeIu9NkIGhcQ/viewform?embedded=true"
        width="100%" height="600" frameborder="0" marginheight="0" marginwidth="0">Loading‚Ä¶</iframe>
      <button id="exit-btn" class="mt-4 px-4 py-2 rounded bg-blue-600 text-white">
        Exit The Labyrinth
      </button>
    </section>
  </div>


  <!-- ============================================== -->
  <!-- ===== MAIN APPLICATION JAVASCRIPT LOGIC ===== -->
  <!-- ============================================== -->
  <script>
    // Tracks attempt counts for every puzzle scene
    window.attempts = {};
    // --- Application State ---
    let currentSceneIndex = 0;
    let isTransitioning = false;
    const allScenes = document.querySelectorAll('.scene');
    const totalScenes = allScenes.length;
    const sceneOrder = Array.from(allScenes).map(scene => scene.id);
    const progressFill = document.getElementById('progressFill');
    const sceneIndicator = document.getElementById('sceneIndicator');

    // Utility function for floating messages (copied from the locks embed)
    function toast(msg, type = 'error') {
      const b = document.createElement('div');
      b.className = 'fixed top-4 left-1/2 -translate-x-1/2 z-50 p-3 rounded-xl shadow text-center font-semibold transition-all duration-300 transform';
      b.textContent = msg;
      b.style.background = (type === 'success') ? 'var(--ok)' : 'var(--err)';
      b.style.color = '#fff';
      document.body.appendChild(b);
      setTimeout(() => {
        b.style.opacity = '0';
        b.addEventListener('transitionend', () => b.remove());
      }, 3500);
    }

    // --- Core Navigation ---

    /** Shows the current scene and hides others. */
    function showScene(index) {
      allScenes.forEach((scene, i) => {
        scene.classList.remove('active');
        if (i === index) {
          scene.classList.add('active');
        }
      });
      currentSceneIndex = index;
      updateProgress();
      window.scrollTo(0, 0);

      // Call setup functions for specific scenes if needed (like the literature puzzle)
      if (allScenes[index].id === 'scene4' && typeof setupLiterature === 'function') {
        setupLiterature();
      }
    }

    /** Moves to the next logical scene. */
    function nextScene() {
      // Prevent double-clicks during transitions
      if (isTransitioning) return;

      if (currentSceneIndex < allScenes.length - 1) {
        isTransitioning = true;
        showScene(currentSceneIndex + 1);
        // Re-enable after a short delay
        setTimeout(() => { isTransitioning = false; }, 500);
      } else {
        toast("Congratulations, you finished the Labyrinth!", 'success');
      }
    }

    /** Updates the progress bar and indicator text. */
    function updateProgress() {
      // Calculate unique scenes for progress (ignores scenes with duplicate IDs like 'scene2' and 'scene3')
      const uniqueScenes = Array.from(new Set(sceneOrder));
      const currentUniqueSceneIndex = uniqueScenes.indexOf(allScenes[currentSceneIndex].id);

      if (currentUniqueSceneIndex === -1) {
        // If we're on a transition screen (like the second 'scene2'), use the previous one's index
        const prevSceneId = allScenes[currentSceneIndex - 1].id;
        const prevUniqueIndex = uniqueScenes.indexOf(prevSceneId);
        progressFill.style.width = `${((prevUniqueIndex + 1) / uniqueScenes.length) * 100}%`;
        sceneIndicator.textContent = `Scene ${prevUniqueIndex + 1} of ${uniqueScenes.length}`;
      } else {
        const progress = ((currentUniqueSceneIndex + 1) / uniqueScenes.length) * 100;
        progressFill.style.width = `${progress}%`;
        sceneIndicator.textContent = `Scene ${currentUniqueSceneIndex + 1} of ${uniqueScenes.length}`;
      }
    }


    // --- Custom Validation Functions ---

    /** Validates the initial access password. */
    function checkPassword() {
      const passwordInput = document.getElementById('password').value.trim().toLowerCase();
      if (passwordInput === 'tpt!2023') { // Example password
        toast('Access granted!', 'success');
        nextScene();
      } else {
        toast('Incorrect password. Try again.', 'error');
      }
    }

    /** Validates a generic riddle answer (like St. Ives) with up to 5 tries. */
    function checkAnswer(sceneId, inputId) {
      const maxTries = 5;

      const inputElement = document.getElementById(inputId);
      const sceneElement = document.getElementById(sceneId);

      if (!inputElement || !sceneElement) {
        toast('Error: Could not find the input or scene for this puzzle.', 'error');
        return;
      }

      // Use data-key if present (e.g., data-key="stIves"), otherwise fall back to the inputId
      const key = sceneElement.dataset.key || inputId;

      // Initialize / increment attempts for this puzzle
      if (typeof attempts === 'undefined') {
        window.attempts = {};
      }
      attempts[key] = (attempts[key] || 0) + 1;

      const rawAnswer = (inputElement.value || '').trim().toLowerCase();
      const hiddenAnswerP = sceneElement.querySelector('.hidden-answer');

      if (!hiddenAnswerP) {
        toast('Error: Could not find validation data for this scene.', 'error');
        return;
      }

      // Try to parse the expected answer from the hidden paragraph.
      // Example formats:
      //   "Answer: 1 (only the narrator...)"
      //   "Answer: Michelle"
      let expectedAnswerText = hiddenAnswerP.textContent.trim();

      // If it starts with "Answer:", strip that off
      const colonIndex = expectedAnswerText.toLowerCase().indexOf('answer:');
      if (colonIndex !== -1) {
        expectedAnswerText = expectedAnswerText
          .slice(colonIndex + 'answer:'.length)
          .trim();
      }

      // If there's extra explanation in parentheses, strip that off
      const parenIndex = expectedAnswerText.indexOf('(');
      if (parenIndex !== -1) {
        expectedAnswerText = expectedAnswerText.slice(0, parenIndex).trim();
      }

      expectedAnswerText = expectedAnswerText.toLowerCase();

      // Check correctness
      if (rawAnswer === expectedAnswerText) {
        toast('Correct!', 'success');
        nextScene();
        return;
      }

      // Wrong answer
      inputElement.value = '';

      const triesUsed = attempts[key];
      const triesLeft = maxTries - triesUsed;

      if (triesLeft > 0) {
        const label = triesLeft === 1 ? 'try' : 'tries';
        toast(`That is not the correct answer. ${triesLeft} ${label} left.`, 'error');
      } else {
        // Out of tries: reveal the answer and move on
        hiddenAnswerP.style.display = 'block';
        toast(`Out of tries! The correct answer is: "${expectedAnswerText}".`, 'error');
        inputElement.disabled = true;

        // Small pause so they can see the message / answer
        setTimeout(() => {
          nextScene();
        }, 3500);
      }
    }
    /**
     * Checks the user's answers against the Cat Riddle solutions using concise boolean accumulation.
     */
    // Max attempts for the Cat riddles
    let catAttempts = 0;
    const CAT_MAX_ATTEMPTS = 5;

    function checkCatRiddles() {
      const input1 = document.getElementById('cat1');
      const input2 = document.getElementById('cat2');
      const input3 = document.getElementById('cat3');
      const feedback = document.getElementById('cat-feedback'); // optional

      // How many answers are correct?
      const correctCount =
        (input1.value.trim() === '11') +                // Riddle 1: exactly "11"
        (/clock/i.test(input2.value.trim())) +          // Riddle 2: contains "clock"
        (/(rain|raining)/i.test(input3.value.trim()));  // Riddle 3: contains "rain" or "raining"

      if (feedback) {
        feedback.className = 'mt-4 text-center font-semibold';
      }

      // All correct
      if (correctCount === 3) {
        if (feedback) {
          feedback.textContent = "All riddles solved! The Cat nods approvingly.";
          feedback.classList.remove('text-red-600');
          feedback.classList.add('text-green-600');
        }

        catAttempts = 0; // reset for next time
        setTimeout(() => {
          if (typeof nextScene === 'function') nextScene();
        }, 3500);
        return;
      }

      // Not all correct: use up an attempt
      catAttempts++;
      const triesLeft = CAT_MAX_ATTEMPTS - catAttempts;

      // Still have tries left
      if (triesLeft > 0) {
        if (feedback) {
          feedback.textContent =
            `That is not correct. ${triesLeft} attempt${triesLeft === 1 ? '' : 's'} left.`;
          feedback.classList.remove('text-green-600');
          feedback.classList.add('text-red-600');
        }

        // Clear only the incorrect ones to nudge them
        if (input1.value.trim() !== '11') input1.value = '';
        if (!/clock/i.test(input2.value.trim())) input2.value = '';
        if (!/(rain|raining)/i.test(input3.value.trim())) input3.value = '';

        return;
      }

      // Out of attempts ‚Äî show answers and move on
      const answerText =
        "Out of attempts! The correct answers are:\n\n" +
        "1) 11\n" +
        "2) clock\n" +
        "3) it's not raining";

      // Reveal the hidden-answer paragraph if it exists
      const hidden = document.querySelector('#scene5 .hidden-answer');
      if (hidden) hidden.style.display = 'block';

      // Show a message, using toast() if you have it, otherwise alert()
      if (typeof toast === 'function') {
        toast(answerText, 'error');
      } else {
        alert(answerText);
      }

      // Advance after a short delay
      setTimeout(() => {
        if (typeof nextScene === 'function') nextScene();
      }, 3500);
    }
    /**
 * Validates the vine unscrambling puzzle with 3 attempt limit.
 */
    function checkVines() {
      const answers = {
        vine1: 'maze',
        vine2: 'statue',
        vine3: 'puzzle',
        vine4: 'lock',
        vine5: 'lost'
      };

      // Initialize attempt counter if it doesn't exist
      if (!window.vineAttempts) {
        window.vineAttempts = 0;
      }

      let correctCount = 0;
      let allCorrect = true;

      // Check each answer
      for (let i = 1; i <= 5; i++) {
        const input = document.getElementById(`vine${i}`);
        const userAnswer = input.value.trim().toLowerCase();
        const correctAnswer = answers[`vine${i}`];

        if (userAnswer === correctAnswer) {
          correctCount++;
          input.style.borderColor = '#10b981'; // Green border for correct
        } else {
          allCorrect = false;
          input.style.borderColor = '#dc2626'; // Red border for incorrect
        }
      }

      if (allCorrect) {
        toast('The vines untangle! You may pass.', 'success');
        setTimeout(nextScene, 3500);
      } else {
        window.vineAttempts++;

        if (window.vineAttempts >= 5) {
          toast(`The vines show you the answers: ${Object.values(answers).join(', ')}. You may now continue.`, 'success');
          // Fill in correct answers
          for (let i = 1; i <= 5; i++) {
            document.getElementById(`vine${i}`).value = answers[`vine${i}`];
            document.getElementById(`vine${i}`).style.borderColor = '#10b981';
          }
          setTimeout(nextScene, 3500);
        } else {
          toast(`${correctCount} out of 5 correct. ${5 - window.vineAttempts} attempts remaining.`, 'error');
        }
      }
    }

    // --- Initialization ---

    // Ensure initial progress is set correctly
    document.addEventListener('DOMContentLoaded', () => {
      showScene(0);
      updateProgress();
    });
    // --- Developer Shortcut: Jump Forward ---
    // Shift + Space to jump forward to next scene.
    document.addEventListener('keydown', (e) => {
      if (e.shiftKey && e.code === 'Space') {
        e.preventDefault(); // Prevent default space bar action (scrolling)
        nextScene();
      }
    });
    // --- Developer Shortcut: Backward ---
    // Shift + Backspace ‚Üí jump backward
    document.addEventListener('keydown', (e) => {
      if (e.shiftKey && e.code === 'Backspace') {
        e.preventDefault();

        const scenes = document.querySelectorAll('.scene');
        const current = document.querySelector('.scene.active');
        const idx = [...scenes].indexOf(current);

        if (idx > 0) {
          scenes[idx].classList.remove('active');
          scenes[idx - 1].classList.add('active');
          window.scrollTo(0, 0);
        }
      }
    });
  </script>
  <script>
    document.getElementById('exit-btn').addEventListener('click', () => {
      // Change this to wherever you want them to ‚Äúreturn‚Äù to
      window.location.href = 'https://www.google.com';
    });
  </script>
</body>

</html>
